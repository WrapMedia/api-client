!function(t){function n(e){if(r[e])return r[e].exports;var o=r[e]={exports:{},id:e,loaded:!1};return t[e].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var r={};return n.m=t,n.c=r,n.p="",n(0)}([function(t,n,r){var e;e=r(1),window.Wrap=new e},function(t,n,r){var e,o,i;e=r(2),i=r(3),o=function(){function t(){}return t.prototype.createClient=function(t){return null==t&&(t=i.PRODUCTION_API_URL),new e(t)},t}(),t.exports=o},function(t,n,r){var e,o,i,a;i=r(3),a=r(4),e=r(5),o=function(){function t(t){this.baseUrl=t}return t.prototype.getAuthHeader=function(){return{Authorization:this._authorization}},t.prototype.authorize=function(t){return null==t&&(t={}),t.client_id=i.CLIENT_ID,a.post(this.baseUrl+"/auth/sign_in",{body:t}).then(function(t){return function(n){t._authorization=n.authorization}}(this))},t.prototype.listWraps=function(t){var n;return n={headers:this.getAuthHeader(),search:t},a.get(this.baseUrl+"/wraps",n)},t.prototype.getWrap=function(t,n){var r;return r={headers:this.getAuthHeader(),search:n},a.get(this.baseUrl+"/wraps/"+t,r).then(function(t){return function(n){return new e(n,t)}}(this))},t}(),t.exports=o},function(t,n){var r;r={CLIENT_ID:"authoring",PRODUCTION_API_URL:"https://wrapi.wrap.co/api",HTTP_METHODS:{GET:"get",POST:"post",PUT:"put",DELETE:"delete"}},t.exports=r},function(t,n,r){(function(n){var e,o,i,a,u,s;u=r(3).HTTP_METHODS,o=function(t){var n;return null==t&&(t={}),n=function(n){return encodeURIComponent(n)+"="+encodeURIComponent(t[n])},"?"+Object.keys(t).map(n).join("&")},s=function(t){return null!=t?t.json():void 0},e=function(t){var n;if(t.status>=200&&t.status<300)return t;throw n=new Error(t.statusText),n.response=t,n},a=function(t,r,i){return null==t&&(t="GET"),null==i&&(i={}),i.method=t,(i.method===u.POST||i.method===u.PUT)&&(i.headers=i.headers||{},Object.assign(i.headers,{Accepts:"application/json","Content-Type":"application/json"})),i.body&&(i.body=JSON.stringify(i.body)),i.search&&(r+=o(i.search),delete i.search),n(r,i).then(e).then(s)},i={get:function(t,n){return a(u.GET,t,n)},post:function(t,n){return a(u.POST,t,n)},put:function(t,n){return a(u.PUT,t,n)},"delete":function(t,n){return a(u.DELETE,t,n)}},t.exports=i}).call(n,r(!function(){var t=new Error('Cannot find module "imports?this=>global!exports?global.fetch!whatwg-fetch"');throw t.code="MODULE_NOT_FOUND",t}()))},function(t,n,r){var e,o;o=r(4),e=function(){function t(t,n){this._client=n,Object.assign(this,t)}return t.prototype._createCardMap=function(t,n){var r;return r={},t.forEach(function(t,e){return r[t.id]=n[e].id}),r},t.prototype._convertSchemaMapToCards=function(t){var n,r,e;r=[];for(n in t)e=t[n],r.push({id:n,schema:e});return r},t.prototype._assignTargetIds=function(t,n){var r,e,o,i;for(e=this._createCardMap(t,n),o=0,i=t.length;i>o;o++)r=t[o],r.id=e[r.id];return t},t.prototype._convertCardsToSchemaMap=function(t){var n;return n={},t.forEach(function(t,r){return n[t.id]=t.schema}),n},t.prototype._createPersonalizedWrap=function(t){var n;return n={headers:this._client.getAuthHeader(),body:t},o.post(this._client.baseUrl+"/wraps/"+this.id+"/personalize",n)},t.prototype.personalize=function(t){return this._client.getWrap(this.id,{published:!0}).then(function(n){return function(r){var e;return e=n._convertSchemaMapToCards(t),e=n._assignTargetIds(e,r.cards),t=n._convertCardsToSchemaMap(e),n._createPersonalizedWrap({personalized_json:t})}}(this))},t}(),t.exports=e}]);